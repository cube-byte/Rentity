<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Reserva</title>
    <link rel="stylesheet" href="/Frontend/css/admin/layout.css">
    <link rel="stylesheet" href="/Frontend/css/admin/layout_2.css">
    <link rel="stylesheet" href="/Frontend/css/admin/Reserva_create.css">
</head>
<body>
    <nav class="navegador">
        <div class="nav_top">
            <div class="nav-logo">
                <img src="/Frontend/recursos/img/Rentity-Logo.png" alt="">
            </div>
            <div class="nav-title">
                <h1><b>RENTIFY</b> System</h1>
            </div>
        </div>
        <div class="nav_buttom">
            <ul>
                <a href="/Frontend/html/admin/Dashboard.html">
                    <li class="li-menu">
                        <svg class="nav_icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#000000" viewBox="0 0 256 256"><path d="M219.31,108.68l-80-80a16,16,0,0,0-22.62,0l-80,80A15.87,15.87,0,0,0,32,120v96a8,8,0,0,0,8,8H216a8,8,0,0,0,8-8V120A15.87,15.87,0,0,0,219.31,108.68ZM208,208H48V120l80-80,80,80Z"></path></svg>
                        Dashboard
                    </li>
                </a>
                <li class="menu-item">
                    <div class="menu-link">
                        <svg class="nav_icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#000000" viewBox="0 0 256 256"><path d="M240,104H229.2L201.42,41.5A16,16,0,0,0,186.8,32H69.2a16,16,0,0,0-14.62,9.5L26.8,104H16a8,8,0,0,0,0,16h8v80a16,16,0,0,0,16,16H64a16,16,0,0,0,16-16V184h96v16a16,16,0,0,0,16,16h24a16,16,0,0,0,16-16V120h8a8,8,0,0,0,0-16ZM69.2,48H186.8l24.89,56H44.31ZM64,200H40V184H64Zm128,0V184h24v16Zm24-32H40V120H216ZM56,144a8,8,0,0,1,8-8H80a8,8,0,0,1,0,16H64A8,8,0,0,1,56,144Zm112,0a8,8,0,0,1,8-8h16a8,8,0,0,1,0,16H176A8,8,0,0,1,168,144Z"></path></svg>
                        Vehiculos
                    </div>
                    <ul class="submenu">
                        <a href="/Frontend/html/admin/Vehiculos.html"><li>Vehiculos</li></a>
                        <a href="/Frontend/html/admin/Autos.html"><li>Autos</li></a>
                    </ul>
                </li>
                <li class="menu-item">
                    <div class="menu-link">
                        <svg class="nav_icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#000000" viewBox="0 0 256 256"><path d="M104,216a16,16,0,1,1-16-16A16,16,0,0,1,104,216Zm88-16a16,16,0,1,0,16,16A16,16,0,0,0,192,200ZM239.71,74.14l-25.64,92.28A24.06,24.06,0,0,1,191,184H92.16A24.06,24.06,0,0,1,69,166.42L33.92,40H16a8,8,0,0,1,0-16H40a8,8,0,0,1,7.71,5.86L57.19,64H232a8,8,0,0,1,7.71,10.14ZM221.47,80H61.64l22.81,82.14A8,8,0,0,0,92.16,168H191a8,8,0,0,0,7.71-5.86Z"></path></svg>
                        Ventas
                    </div>
                    <ul class="submenu">
                        <a href="/Frontend/html/admin/Reservas.html"><li>Reservas</li></a>
                        <a href="#"><li>Pagos</li></a>
                        <a href="#"><li>Comprobantes</li></a>
                    </ul>
                </li>
                <li class="menu-item">
                    <div class="menu-link">
                        <svg class="nav_icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#000000" viewBox="0 0 256 256"><path d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z"></path></svg>
                        Clientes
                    </div>
                    <ul class="submenu">
                        <a href="/Frontend/html/admin/Usuarios.html"><li>Clientes</li></a>
                        <a href="/Frontend/html/admin/Ubicaciones.html"><li>Ubicaciones</li></a>
                    </ul>
                </li>
                <a href="/Frontend/html/user/Catalogo.html">
                    <li class="li-menu">
                        <svg class="nav_icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#000000" viewBox="0 0 256 256"><path d="M128,24h0A104,104,0,1,0,232,128,104.12,104.12,0,0,0,128,24Zm88,104a87.61,87.61,0,0,1-3.33,24H174.16a157.44,157.44,0,0,0,0-48h38.51A87.61,87.61,0,0,1,216,128ZM102,168H154a115.11,115.11,0,0,1-26,45A115.27,115.27,0,0,1,102,168Zm-3.9-16a140.84,140.84,0,0,1,0-48h59.88a140.84,140.84,0,0,1,0,48ZM40,128a87.61,87.61,0,0,1,3.33-24H81.84a157.44,157.44,0,0,0,0,48H43.33A87.61,87.61,0,0,1,40,128ZM154,88H102a115.11,115.11,0,0,1,26-45A115.27,115.27,0,0,1,154,88Zm52.33,0H170.71a135.28,135.28,0,0,0-22.3-45.6A88.29,88.29,0,0,1,206.37,88ZM107.59,42.4A135.28,135.28,0,0,0,85.29,88H49.63A88.29,88.29,0,0,1,107.59,42.4ZM49.63,168H85.29a135.28,135.28,0,0,0,22.3,45.6A88.29,88.29,0,0,1,49.63,168Zm98.78,45.6a135.28,135.28,0,0,0,22.3-45.6h35.66A88.29,88.29,0,0,1,148.41,213.6Z"></path></svg>
                        Website
                    </li>
                </a>
                <a href="#" id="btn-cerrar-sesion">
                    <li class="li-menu">
                        <svg class="nav_icon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="#000000" viewBox="0 0 256 256"><path d="M120,216a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h64a8,8,0,0,1,0,16H56V208h56A8,8,0,0,1,120,216Zm109.66-93.66-40-40a8,8,0,0,0-11.32,11.32L204.69,120H112a8,8,0,0,0,0,16h92.69l-26.35,26.34a8,8,0,0,0,11.32,11.32l40-40A8,8,0,0,0,229.66,122.34Z"></path></svg>
                        Salir
                    </li>
                </a>
            </ul>
        </div>
    </nav>

    <div class="container">
        <section class="container-top">
            <div class="perfil">
                <div class="perfil-correo">
                    <h1 class="correo" id="perfilEmail">cargando...</h1>
                    <h1 class="rango" id="perfilRol">-</h1>
                </div>
                <div class="perfil-img">
                    <img src="/Frontend/recursos/img/icons/person-icon.webp" alt="">
                </div>
            </div>
        </section>

        <section class="container-body">
            <div class="guia">
                <h2 class="main-guia">Dashboard</h2>
                <h2>/</h2>
                <h2 class="sub-guia">Ventas</h2>
                <h2>/</h2>
                <h2 class="sub-guia">Reservas</h2>
                <h2>/</h2>
                <h2 class="sub-guia">Editar</h2>
            </div>
            <div class="title">
                <h1>Editar Reserva <span id="tituloId" style="color:#888; font-size:0.8em;"></span></h1>
            </div>
            <div class="create-section">
                <form style="display: flex;flex-direction: column;">
                    <div class="from">
                        <div class="form-body">

                            <!-- DATOS CLIENTE -->
                            <div class="cliente_select-box">
                                <h2 class="h2-box">Datos Cliente</h2>
                                <div class="buscar-cliente">
                                    <input type="text" id="buscarCliente" placeholder="Ingrese ID del Cliente">
                                    <small class="hint">Presioná Enter para buscar el cliente por ID</small>
                                </div>
                                <div class="cliente-box">
                                    <div class="nombre">
                                        <label>Nombres: *</label>
                                        <input type="text" id="inputNombres" placeholder="" required readonly>
                                    </div>
                                    <div class="email">
                                        <label>Correo: *</label>
                                        <input type="text" id="inputEmail" placeholder="" required readonly>
                                    </div>
                                    <div class="telefono">
                                        <label>Telefono: *</label>
                                        <input type="text" id="inputTelefono" placeholder="" required readonly>
                                    </div>
                                    <div class="dni">
                                        <label>DNI: *</label>
                                        <input type="text" id="inputDni" placeholder="" required readonly>
                                    </div>
                                </div>
                            </div>

                            <!-- VEHICULO -->
                            <div class="vehiculo-box">
                                <h2 class="h2-box">Vehiculo Seleccionado</h2>
                                <div class="vehiculo-selector" id="vehiculoSelector">
                                    <div class="vehiculo-seleccionado" id="vehiculoSeleccionado">
                                        Selecciona un vehículo
                                    </div>
                                    <div class="vehiculo-opciones" id="vehiculoOpciones"></div>
                                </div>
                                <input type="hidden" id="vehiculoId">
                                <input type="hidden" id="autoId">
                            </div>

                            <!-- FECHAS -->
                            <div class="fecha-box">
                                <h2 class="h2-box">Selecciona las Fechas</h2>
                                <div class="fechas-reserva">
                                    <div class="campo">
                                        <label for="fechaInicio">Fecha de inicio</label>
                                        <input type="date" id="fechaInicio">
                                    </div>
                                    <div class="campo">
                                        <label for="fechaFin">Fecha fin</label>
                                        <input type="date" id="fechaFin">
                                    </div>
                                </div>
                            </div>

                            <!-- ESTADO -->
                            <div class="fecha-box">
                                <h2 class="h2-box">Estado de la Reserva</h2>
                                <select id="estadoReserva" style="padding: 8px; border-radius: 6px; border: 1px solid #ccc; font-size: 1em;">
                                    <option value="NUEVA">NUEVA</option>
                                    <option value="CONFIRMADA">CONFIRMADA</option>
                                    <option value="REALIZADA">REALIZADA</option>
                                    <option value="TERMINADA">TERMINADA</option>
                                </select>
                            </div>

                            <!-- PRECIO -->
                            <div class="precio-box">
                                <div class="precio-calculo">
                                    <span class="detalle" style="display: flex;">
                                        <p style="margin: 0px 5px;" id="dias-vista">0</p> días x S/
                                        <p style="margin: 0px 5px;" id="precio-vista">0</p> por día
                                    </span>
                                    <p class="subtotal" id="subtotal">S/ 0</p>
                                </div>
                                <div class="precio-total">
                                    <span>Total a pagar</span>
                                    <strong>S/ <span id="precio">0</span></strong>
                                </div>
                            </div>

                        </div>
                        <div class="button-box">
                            <button type="button" id="btnCancelar" class="btn btn-cancelar">Cancelar</button>
                            <button type="button" id="btnGuardar" class="btn btn-primario">Guardar cambios</button>
                        </div>
                    </div>
                </form>
            </div>
        </section>
    </div>

    <script>
        // ── SELECTOR DE VEHICULO (mismo lógica que crear) ─────────────
        const selector    = document.getElementById("vehiculoSelector");
        const seleccionado = selector.querySelector(".vehiculo-seleccionado");
        const opciones    = selector.querySelector(".vehiculo-opciones");

        seleccionado.addEventListener("click", () => {
            opciones.style.display = opciones.style.display === "block" ? "none" : "block";
        });

        function bindOpciones() {
            selector.querySelectorAll(".vehiculo-opcion").forEach(op => {
                op.addEventListener("click", () => {
                    seleccionado.innerHTML = `<div class="vehiculo-card"><div class="vehiculo_rederizar-img">${op.innerHTML}</div></div>`;
                    document.getElementById("vehiculoId").value = op.dataset.id;
                    opciones.style.display = "none";
                });
            });
        }

        // ── CÁLCULO DE PRECIO ─────────────────────────────────────────
        const fechaInicio = document.getElementById("fechaInicio");
        const fechaFin    = document.getElementById("fechaFin");

        fechaInicio.addEventListener("change", calcular);
        fechaFin.addEventListener("change", calcular);

        function calcular() {
            const inicio = fechaInicio.value;
            const fin    = fechaFin.value;
            if (!inicio || !fin) return;

            const dias = Math.ceil((new Date(fin) - new Date(inicio)) / 86400000);
            if (dias < 0) {
                alert("No se puede poner fechas negativas");
                fechaFin.value = '';
                return;
            }
            const precioDia = parseFloat(document.getElementById("precio-vista").textContent) || 0;
            const total = dias * precioDia;

            document.getElementById("dias-vista").textContent  = dias;
            document.getElementById("precio").textContent      = total;
            document.getElementById("subtotal").textContent    = "S/ " + total;
        }
    </script>

    <script src="/Frontend/ts/menu.js"></script>
    <script src="/Frontend/js/extras/cargar_vehiculosDetallados.js"></script>
    <script src="/Frontend/js/editReservas.js"></script>
</body>
</html>